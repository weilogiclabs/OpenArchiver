import{_ as e,c as i,o,ag as r}from"./chunks/framework.S-Qvb3wi.js";const u=JSON.parse('{"title":"Connecting to Microsoft 365","description":"","frontmatter":{},"headers":[],"relativePath":"user-guides/email-providers/microsoft-365.md","filePath":"user-guides/email-providers/microsoft-365.md"}'),n={name:"user-guides/email-providers/microsoft-365.md"};function s(a,t,l,c,h,p){return o(),i("div",null,t[0]||(t[0]=[r('<h1 id="connecting-to-microsoft-365" tabindex="-1">Connecting to Microsoft 365 <a class="header-anchor" href="#connecting-to-microsoft-365" aria-label="Permalink to &quot;Connecting to Microsoft 365&quot;">​</a></h1><p>This guide provides instructions for Microsoft 365 administrators to set up a connection that allows the archiving of all user mailboxes within their organization.</p><p>The connection uses the <strong>Microsoft Graph API</strong> and an <strong>App Registration</strong> in Microsoft Entra ID. This is a secure, standard method that grants the archiving service permission to read email data on your behalf without ever needing to handle user passwords.</p><h2 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">​</a></h2><ul><li>You must have one of the following administrator roles in your Microsoft 365 tenant: <strong>Global Administrator</strong>, <strong>Application Administrator</strong>, or <strong>Cloud Application Administrator</strong>.</li></ul><h2 id="setup-overview" tabindex="-1">Setup Overview <a class="header-anchor" href="#setup-overview" aria-label="Permalink to &quot;Setup Overview&quot;">​</a></h2><p>The setup process involves four main parts, all performed within the Microsoft Entra admin center and the OpenArchiver application:</p><ol><li>Registering a new application identity for the archiver in Entra ID.</li><li>Granting the application the specific permissions it needs to read mail.</li><li>Creating a secure password (a client secret) for the application.</li><li>Entering the generated credentials into the OpenArchiver application.</li></ol><hr><h3 id="part-1-register-a-new-application-in-microsoft-entra-id" tabindex="-1">Part 1: Register a New Application in Microsoft Entra ID <a class="header-anchor" href="#part-1-register-a-new-application-in-microsoft-entra-id" aria-label="Permalink to &quot;Part 1: Register a New Application in Microsoft Entra ID&quot;">​</a></h3><p>First, you will create an &quot;App registration,&quot; which acts as an identity for the archiving service within your Microsoft 365 ecosystem.</p><ol><li>Sign in to the <a href="https://entra.microsoft.com" target="_blank" rel="noreferrer">Microsoft Entra admin center</a>.</li><li>In the left-hand navigation pane, go to <strong>Identity &gt; Applications &gt; App registrations</strong>.</li><li>Click the <strong>+ New registration</strong> button at the top of the page.</li><li>On the &quot;Register an application&quot; screen: <ul><li><strong>Name:</strong> Give the application a descriptive name you will recognize, such as <code>OpenArchiver Service</code>.</li><li><strong>Supported account types:</strong> Select <strong>&quot;Accounts in this organizational directory only (Default Directory only - Single tenant)&quot;</strong>. This is the most secure option.</li><li><strong>Redirect URI (optional):</strong> You can leave this blank.</li></ul></li><li>Click the <strong>Register</strong> button. You will be taken to the application&#39;s main &quot;Overview&quot; page.</li></ol><hr><h3 id="part-2-grant-api-permissions" tabindex="-1">Part 2: Grant API Permissions <a class="header-anchor" href="#part-2-grant-api-permissions" aria-label="Permalink to &quot;Part 2: Grant API Permissions&quot;">​</a></h3><p>Next, you must grant the application the specific permissions required to read user profiles and their mailboxes.</p><ol><li>From your new application&#39;s page, select <strong>API permissions</strong> from the left-hand menu.</li><li>Click the <strong>+ Add a permission</strong> button.</li><li>In the &quot;Request API permissions&quot; pane, select <strong>Microsoft Graph</strong>.</li><li>Select <strong>Application permissions</strong>. This is critical as it allows the service to run in the background without a user being signed in.</li><li>In the &quot;Select permissions&quot; search box, find and check the boxes for the following two permissions: <ul><li><code>Mail.Read</code></li><li><code>User.Read.All</code></li></ul></li><li>Click the <strong>Add permissions</strong> button at the bottom.</li><li><strong>Crucial Final Step:</strong> You will now see the permissions in your list with a warning status. You must grant consent on behalf of your organization. Click the <strong>&quot;Grant admin consent for [Your Organization&#39;s Name]&quot;</strong> button located above the permissions table. Click <strong>Yes</strong> in the confirmation dialog. The status for both permissions should now show a green checkmark.</li></ol><hr><h3 id="part-3-create-a-client-secret" tabindex="-1">Part 3: Create a Client Secret <a class="header-anchor" href="#part-3-create-a-client-secret" aria-label="Permalink to &quot;Part 3: Create a Client Secret&quot;">​</a></h3><p>The client secret is a password that the archiving service will use to authenticate. Treat this with the same level of security as an administrator&#39;s password.</p><ol><li>In your application&#39;s menu, navigate to <strong>Certificates &amp; secrets</strong>.</li><li>Select the <strong>Client secrets</strong> tab and click <strong>+ New client secret</strong>.</li><li>In the pane that appears: <ul><li><strong>Description:</strong> Enter a clear description, such as <code>OpenArchiver Key</code>.</li><li><strong>Expires:</strong> Select an expiry duration. We recommend <strong>12 or 24 months</strong>. Set a calendar reminder to renew it before it expires to prevent service interruption.</li></ul></li><li>Click <strong>Add</strong>.</li><li><strong>IMMEDIATELY COPY THE SECRET:</strong> The secret is now visible in the <strong>&quot;Value&quot;</strong> column. This is the only time it will be fully displayed. Copy this value now and store it in a secure password manager before navigating away. If you lose it, you must create a new one.</li></ol><hr><h3 id="part-4-connecting-in-openarchiver" tabindex="-1">Part 4: Connecting in OpenArchiver <a class="header-anchor" href="#part-4-connecting-in-openarchiver" aria-label="Permalink to &quot;Part 4: Connecting in OpenArchiver&quot;">​</a></h3><p>You now have the three pieces of information required to configure the connection.</p><ol><li><p><strong>Navigate to Ingestion Sources:</strong> In the OpenArchiver application, go to the <strong>Ingestion Sources</strong> page.</p></li><li><p><strong>Create a New Source:</strong> Click the <strong>&quot;Create New&quot;</strong> button.</p></li><li><p><strong>Fill in the Configuration Details:</strong></p><ul><li><strong>Name:</strong> Give the source a name (e.g., &quot;Microsoft 365 Archive&quot;).</li><li><strong>Provider:</strong> Select <strong>&quot;Microsoft 365&quot;</strong> from the dropdown.</li><li><strong>Application (Client) ID:</strong> Go to the <strong>Overview</strong> page of your app registration in the Entra admin center and copy this value.</li><li><strong>Directory (Tenant) ID:</strong> This value is also on the <strong>Overview</strong> page.</li><li><strong>Client Secret Value:</strong> Paste the secret <strong>Value</strong> (not the Secret ID) that you copied and saved in the previous step.</li></ul></li><li><p><strong>Save Changes:</strong> Click <strong>&quot;Save changes&quot;</strong>.</p></li></ol><h2 id="what-happens-next" tabindex="-1">What Happens Next? <a class="header-anchor" href="#what-happens-next" aria-label="Permalink to &quot;What Happens Next?&quot;">​</a></h2><p>Once the connection is saved, the system will begin the archiving process:</p><ol><li><strong>User Discovery:</strong> The service will connect to the Microsoft Graph API to get a list of all users in your organization.</li><li><strong>Initial Import:</strong> The system will begin a background job to import the mailboxes of all discovered users, folder by folder. The status will show as <strong>&quot;Importing&quot;</strong>. This can take a significant amount of time.</li><li><strong>Continuous Sync:</strong> After the initial import, the status will change to <strong>&quot;Active&quot;</strong>. The system will use Microsoft Graph&#39;s delta query feature to efficiently fetch only new or changed emails, ensuring the archive stays up-to-date.</li></ol>',27)]))}const d=e(n,[["render",s]]);export{u as __pageData,d as default};
